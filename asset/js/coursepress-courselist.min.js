/*!  - v2.0.0
 * 
 * Copyright (c) 2016; * Licensed GPLv2+ */
var CoursePress=CoursePress||{};(function(e){CoursePress.Models.Course=CoursePress.Models.Course||Backbone.Model.extend({url:_coursepress._ajax_url+"?action=update_course",parse:function(e){!0===e.success?(this.set("response_data",e.data),this.trigger("coursepress:"+e.data.action+"_success",e.data)):(this.set("response_data",{}),this.trigger("coursepress:"+e.data.action+"_error",e.data)),CoursePress.Course.set("action","")},defaults:{}}),CoursePress.Course=new CoursePress.Models.Course,e(document).ready(function(e){e('[name*="publish-course-toggle"]').on("change",function(s,t){var r=e(this).attr("data-nonce"),o="off"===t?"draft":"publish",n=parseInt(e(this).attr("id").replace("publish-course-toggle-",""));CoursePress.Course.set("action","toggle_course_status");var a={nonce:r,status:o,state:t,course_id:n};CoursePress.Course.set("data",a),CoursePress.Course.save()}),CoursePress.Course.on("coursepress:toggle_course_status_success",function(s){e('[name="publish-course-toggle-'+s.course_id+'"]').attr("data-nonce",s.nonce)}),CoursePress.Course.on("coursepress:toggle_course_status_error",function(s){var t=e('[name="publish-course-toggle-'+s.course_id+'"]');e(t).hasClass("on")?e(t).removeClass("on").addClass("off"):e(t).hasClass("off")&&e(t).removeClass("off").addClass("on")}),e(".bulkactions .button.action").on("click",function(){var s=e(".nonce-holder").attr("data-nonce"),t=[];e.each(e('[name="bulk-actions[]"]'),function(s,r){e(r).is(":checked")&&t.push(e(r).val())});var r=e(this).siblings("select").val();r="-1"===r?"":r;var o=!0;if("delete"===r&&(o=window.confirm(_coursepress.courselist_bulk_delete)),r.length>0&&o){CoursePress.Course.set("action","bulk_actions");var n={nonce:s,the_action:r,courses:t};CoursePress.Course.set("data",n),CoursePress.Course.save()}}),CoursePress.Course.on("coursepress:bulk_actions_success",function(s){e(".nonce-holder").attr("data-nonce",s.nonce),window.location.reload()}),CoursePress.Course.on("coursepress:bulk_actions_error",function(){window.location.reload()}),e(".delete-course-link").on("click",function(s){if(s.stopImmediatePropagation(),s.preventDefault(),window.confirm(_coursepress.courselist_delete_course)){CoursePress.Course.set("action","delete_course");var t={nonce:e(this).attr("data-nonce"),course_id:e(this).attr("data-id")};CoursePress.Course.set("data",t),CoursePress.Course.save()}}),CoursePress.Course.on("coursepress:delete_course_success",function(){window.location.reload()}),e(".duplicate-course-link").on("click",function(s){if(s.stopImmediatePropagation(),s.preventDefault(),window.confirm(_coursepress.courselist_duplicate_course)){CoursePress.Course.set("action","duplicate_course");var t={nonce:e(this).attr("data-nonce"),course_id:e(this).attr("data-id")};CoursePress.Course.set("data",t),CoursePress.Course.save()}}),CoursePress.Course.on("coursepress:duplicate_course_success",function(){window.location.reload()}),e(".coursepress-ui-toggle-switch").coursepress_ui_toggle()})})(jQuery);