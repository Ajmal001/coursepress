/*!  - v2.0.0
 * https://premium.wpmudev.org/project/coursepress-pro/
 * Copyright (c) 2016; * Licensed GPLv2+ */
var CoursePress={};CoursePress.Models=CoursePress.Models||{},CoursePress.Events=_.extend({},Backbone.Events),CoursePress.UI=CoursePress.UI||{},CoursePress.utility=CoursePress.utility||{},function(a){CoursePress.SendRequest=Backbone.Model.extend({url:_coursepress._ajax_url+"?action=coursepress_request",parse:function(a){var b=this.get("action");!0===a.success?(this.set("response_data",a.data),this.trigger("coursepress:"+b+"_success",a.data)):(this.set("response_data",{}),this.trigger("coursepress:"+b+"_error",a.data))}}),CoursePress.resetBrowserURL=function(a){window.history.pushState&&window.history.pushState({},null,a)},CoursePress.Focus=function(b){var c,d=a(b);return 0<d.length&&(c=d.offset().top,c-=100,a(window).scrollTop(c)),!1},CoursePress.showError=function(b,c){var d,e=a('<div class="cp-error cp-error-box"></div>'),f=a("<p>"),g=a('<a class="cp-closed">&times;</a>'),h=a(".cp-error-box");0<h.length&&h.remove(),d=function(){e.remove()},f.html(b).appendTo(e),g.prependTo(e).on("click",d),c.prepend(e),CoursePress.Focus(".cp-error-box")},CoursePress.WindowAlert=Backbone.View.extend({className:"cp-mask cp-window-alert",message:"",callback:!1,type:"alert",html:'<div class="cp-alert-container"><p><button type="button" class="button">OK</button></p></div>',events:{"click .button":"remove"},initialize:function(a){_.extend(this,a),Backbone.View.prototype.initialize.apply(this,arguments),this.render()},render:function(){this.$el.append(this.html),this.container=this.$el.find(".cp-alert-container"),this.container.addClass("cp-"+this.type),this.container.prepend('<p class="msg">'+this.message+"</p>"),this.$el.appendTo("body")}}),CoursePress.Mask=function(b){b=b?b:"body";var c=a('<div class="cp-mask mask"></div>');return c.appendTo(b),{mask:c,done:function(){c.remove()}}},CoursePress.UnitProgressIndicator=function(){var b=a("ul.units-archive-list a").css("color"),c=a("body").css("color").replace("rgb(","").replace(")","").split(","),d="rgba("+c[0]+", "+c[1]+", "+c[2]+", 1)",e=a(this).data(),f=b,g="center",h=4.5,i=!0,j={duration:1200,easing:"circleProgressEase"};e.knobFgColor&&(b=e.knobFgColor),e.knobEmptyColor&&(d=e.knobEmptyColor),e.knobTextColor&&(f=e.knobTextColor),e.knobTextAlign&&(g=e.knobTextAlign),e.knobTextDenominator&&(h=e.knobTextDenominator),"undefined"!=typeof e.knobTextShow&&(i=e.knobTextShow),"undefined"!=typeof e.knobAnimation&&(j=e.knobAnimation);var k={color:b};a(this).circleProgress({fill:k,emptyFill:d,animation:j});a(this).parents("ul")[0];a(this).on("circle-animation-progress",function(b,c){var d=a(this).data("circle-progress"),e=d.ctx,j=d.size,k=(100*c).toFixed(),l=(100*d.value).toFixed();k=100-k,k<l&&(k=l),e.save(),i&&(e.font=j/h+"px sans-serif",e.textAlign=g,e.textBaseline="middle",e.fillStyle=f,e.fillText(k+"%",j/2+j/80,j/2)),e.restore()}),a(this).on("circle-animation-end",function(){var b=a(this).data("circle-progress"),c=b.ctx,d=b.size,e=(100*b.value).toFixed();b.drawFrame(b.value),i&&(c.font=d/h+"px sans-serif",c.textAlign=g,c.textBaseline="middle",c.fillStyle=f,c.fillText(e+"%",d/2,d/2))});var l=a(this).data("circle-progress"),m=l.ctx,n=l.size,o=(100*l.value).toFixed();i&&(m.font=n/h+"px sans-serif",m.textAlign=g,m.textBaseline="middle",m.fillStyle=f,m.fillText(o+"%",n/2,n/2+n/80)),"undefined"!=typeof e.knobTextPrepend&&e.knobTextPrepend&&a(this).parent().prepend('<span class="progress">'+o+"%</span>")},CoursePress.unitProgressInit=function(){var b=a(".course-progress-disc");0<b.length&&b.each(CoursePress.UnitProgressIndicator)},CoursePress.Modal=Backbone.Modal.extend({viewContainer:".enrollment-modal-container",submitEl:".done",cancelEl:".cancel",options:"meh",initialize:function(){this.template=_.template(a("#modal-template").html()),this.views=this.getViews()},getViews:function(){var b={},c=a('[data-type="modal-step"]');if(0!==c.length)return a.each(c,function(c,d){var e=c+1,f=a(d).attr("id");void 0!==f&&(b["click #step"+e]={view:_.template(a("#"+f).html()),onActive:"setActive"})}),b},events:{"click .previous":"previousStep","click .next":"nextStep","click .cancel-link":"closeDialog"},previousStep:function(a){a.preventDefault(),this.previous(),"function"==typeof this.onPrevious&&this.onPrevious()},nextStep:function(a){a.preventDefault(),this.next(),"function"==typeof this.onNext&&this.onNext()},closeDialog:function(){return a(".enrolment-container-div").detach(),!1},setActive:function(a){this.trigger("modal:updated",{view:this,options:a})},cancel:function(){return a(".enrolment-container-div").detach(),!1}}),CoursePress.removeErrorHint=function(){a(this).removeClass("has-error")},CoursePress.actions=CoursePress.actions||{},CoursePress.filters=CoursePress.filters||{},CoursePress.add_action=function(a,b,c){void 0===c&&(c=10),CoursePress.actions[a]=CoursePress.actions[a]||[],CoursePress.actions[a].push({priority:c,callback:b})},CoursePress.add_filter=function(a,b,c){void 0===c&&(c=10),CoursePress.filters[a]=CoursePress.filters[a]||[],CoursePress.filters[a].push({priority:c,callback:b})},CoursePress.remove_action=function(a,b){CoursePress.filters[a]=CoursePress.filters[a]||[],CoursePress.filters[a].forEach(function(c,d){c.callback===b&&CoursePress.filters[a].splice(d,1)})},CoursePress.remove_filter=function(a,b){CoursePress.filters[a]=CoursePress.filters[a]||[],CoursePress.filters[a].forEach(function(c,d){c.callback===b&&CoursePress.filters[a].splice(d,1)})},CoursePress.do_action=function(a,b){var c=[];void 0!==CoursePress.actions[a]&&CoursePress.actions[a].length>0&&(CoursePress.actions[a].forEach(function(a){c[a.priority]=c[a.priority]||[],c[a.priority].push(a.callback)}),c.forEach(function(a){a.forEach(function(a){a(b)})}))},CoursePress.apply_filters=function(a,b,c){var d=[];return void 0!==CoursePress.filters[a]&&CoursePress.filters[a].length>0&&(CoursePress.filters[a].forEach(function(a){d[a.priority]=d[a.priority]||[],d[a.priority].push(a.callback)}),d.forEach(function(a){a.forEach(function(a){b=a(b,c)})})),b},a(document).ready(CoursePress.unitProgressInit).on("focus",".cp-mask .has-error, .cp .has-error",CoursePress.removeErrorHint)}(jQuery),function(a){CoursePress.LoadFocusModule=function(){var b=a(this),c=b.data(),d=a(".coursepress-focus-view"),e=[_coursepress.home_url,"coursepress_focus"];if("submit"!==b.attr("type"))return"course"===c.type?void(window.location=c.url):(e.push(c.course,c.unit,c.type,c.id),e=e.join("/"),d.load(e),CoursePress.resetBrowserURL(c.url),!1)},CoursePress.validateUploadModule=function(){var b=a(this),c=b.parents(".module-elements").first(),d=c.find(".invalid-extension, .current-file"),e=b.val(),f=e.split(".").pop(),g=_.keys(_coursepress.allowed_student_extensions);0<d.length&&d.detach(),_.contains(g,f)?(d=a('<div class="current-file"></div>').html(e),d.insertAfter(b.parent())):(d=a('<div class="invalid-extension">').insertAfter(b.parent()),d.html(_coursepress.invalid_upload_message))},CoursePress.ModuleSubmit=function(){var b,c=a(this),d=c.find(".cp-error-box"),e=c.parents(".coursepress-focus-view, .cp.unit-wrapper"),f=!1,g=!1,h=a('.module-elements[data-required="1"]',c),i=0;return 0<d.length&&d.remove(),h.each(function(){var b,c=a(this),d=c.data("type");_.contains(["input-checkbox","input-radio","input-quiz"],d)?(b=a(":checked",c),0==b.length&&(i+=1)):_.contains(["input-upload","input-text","input-textarea","input-select"],d)&&(b=a("input,textarea,select",c),""===b.val()&&(i+=1))}),i>0?(new CoursePress.WindowAlert({message:_coursepress.module_error.required}),!1):(b=CoursePress.Mask(),c.append('<input type="hidden" name="is_cp_ajax" value="1" />'),f=a('<iframe name="cp_submitter" style="display:none;">').insertBefore(c),c.attr("target","cp_submitter"),void f.on("load",function(){var c=a(this).contents().find("body");g=setInterval(function(){var a=c.text();if(""!=a){clearInterval(g),b.done();var d=window.JSON.parse(a);!0===d.success?d.data.url&&(d.data.type&&"completion"===d.data.type?window.location=d.data.url:(e.html(d.data.html),CoursePress.resetBrowserURL(d.data.url))):(d.data.html&&e.html(d.data.html),new CoursePress.WindowAlert({message:d.data.error_message}))}},100)}))},CoursePress.toggleModuleState=function(){var b=a(this),c=b.closest(".cp-module-content"),d=a(".module-elements",c),e=a(".module-response",c);return e.hide(),d.show(),!1},CoursePress.commentReplyLink=function(){var b=a(this),c=b.parents("[data-comid]").first(),d=c.data("comid"),e=b.parents(".cp-module-content").first(),f=a("#respond",e),g=a("#comment-"+d),h=a('[name="comment_parent"]',f),i=a(".cp-temp-div"),j=f.find("#cancel-comment-reply-link");return 0===i.length&&(i=a('<div class="cp-temp-div"></div>').insertAfter(f)),h.val(d),f.hide(),g.append(f.slideDown()),j.off("click"),j.show().on("click",function(){return f.insertBefore(i),j.hide(),i.remove(),!1}),CoursePress.Focus(f),f.find('textarea[name="comment"]').focus(),!1},CoursePress.addComment=function(b){var c,d,e=a(this),f=e.parents(".cp-module-content").first(),g=a("#respond",f),h=a(".cp-comment-form",f),i=a('[name="comment"]',g),j=a('[name="comment_parent"]',g),k=a('[name="comment_post_ID"]',g),l=a('[name="coursepress_subscribe"]',g),m=a('[name="student_id"]',f),n=a('[name="course_id"]',f),o=a('[name="module_content"]',f),p=a(".cp-error-box",g),q=a(".comment-list",f),r={},s=0<parseInt(j.val()),t=new CoursePress.SendRequest;return p.remove(),""===i.val()?(new CoursePress.WindowAlert({message:_coursepress.comments.require_valid_comment}),b.stopImmediatePropagation(),!1):(r={comment:i.val(),comment_parent:j.val(),comment_post_ID:k.val(),subscribe:l.val(),cpnonce:_coursepress.cpnonce,method:"add_single_comment",className:"CoursePress_Module",course_id:n,unit_id:o,student_id:m.val(),action:"add_single_comment"},d=CoursePress.Mask(),c=function(){var a=g.find("#cancel-comment-reply-link");i.val(""),j.val(""),a.is(":visible")&&a.trigger("click"),d.done()},t.set(r),t.off("coursepress:add_single_comment_success"),t.on("coursepress:add_single_comment_success",function(b){c(),0<q&&(q=a('<ol class="comment-list"></ol>').insertAfter(g));var d,e=q,f=h.is(".comment-form-desc")?"append":"prepend";!0===s?(e=a("#comment-"+r.comment_parent),d=e.find(".children"),0===d.length?(e.append('<ul class="children"></ul>'),d=e.find(".children")):d="append"===f?d.last():d.first(),d[f](b.html)):e[f](b.html),CoursePress.Focus("#comment-"+b.comment_id)}),t.on("coursepress:add_single_comment_error",function(){d.done(),CoursePress.showError(_coursepress.server_error,g)}),t.save(),b.stopImmediatePropagation(),!1)},CoursePress.singleFolded=function(){var b=a(">ul",a(this).parent()),c=a(".unit-archive-single-title",a(this).parent()),d=a(".unit-archive-module-wrapper",a(this).parent()),e=a(this);return e.hasClass("folded")?b.slideDown(function(){e.removeClass("folded"),e.closest("li").removeClass("folded").addClass("unfolded"),c.attr("href",c.data("original-href")),c.off("click")}):b.slideUp(function(){if(e.addClass("folded"),e.closest("li").removeClass("unfolded").addClass("folded"),"undefined"==typeof c.data("href")){var b=a(".module-seen",d).last();if(b.length&&(b=a(".module-title",b),b.length))return c.attr("href",c.attr("href")+"#module-"+b.data("id")),!1;var f=a(".section-seen",d).last();if(f.length&&(f=a(".section-title",f),f.length))return c.attr("href",c.attr("href")+"#section-"+f.data("id")),!1}}),!1},CoursePress.unitFolded=function(){var b=a(this),c=b.parents("li").first(),d=c.find(".unit-structure-modules"),e=c.is(".folded");e?(c.removeClass("folded").addClass("unfolded"),b.removeClass("folded"),d.slideDown()):(c.removeClass("unfolded").addClass("folded"),b.addClass("folded"),d.slideUp())},a(document).on("submit",".cp-form",CoursePress.ModuleSubmit).on("click",".focus-nav-prev, .focus-nav-next",CoursePress.LoadFocusModule).on("click",".button-reload-module",CoursePress.toggleModuleState).on("click",".cp-module-content .comment-reply-link",CoursePress.commentReplyLink).on("click",".cp-comment-submit",CoursePress.addComment).on("change",".cp-module-content .file input",CoursePress.validateUploadModule).on("click",".unit-archive-single .fold",CoursePress.singleFolded).on("click",".course-structure-block .unit .fold",CoursePress.unitFolded)}(jQuery),function(a){function b(b){if(void 0===b)return!1;var c,d=a(a('[data-type="modal-step"]')[b]).attr("data-modal-action"),e=a(".enrollment-modal-container.bbm-modal__views").attr("data-nonce");if(CoursePress.Post.prepare("course_enrollment","enrollment:"),CoursePress.Post.set("action",d),!("signup"===d&&(c=CoursePress.Enrollment.dialog.signup_validation,"function"==typeof c&&!0!==c())||"login"===d&&(c=CoursePress.Enrollment.dialog.login_validation,"function"==typeof c&&!0!==c()))){var f={nonce:e,step:b};c=CoursePress.Enrollment.dialog[d+"_data"],"function"==typeof c&&(f=c(f)),CoursePress.Post.set("data",f),CoursePress.Post.save(),CoursePress.Post.on("coursepress:enrollment:"+d+"_success",function(b){return a(".enrollment-modal-container.bbm-modal__views").attr("data-nonce",b.nonce),void 0!==b.callback&&(c=CoursePress.Enrollment.dialog[b.callback],"function"==typeof c)?void c(b):void(void 0!==b.last_step&&parseInt(b.last_step)<CoursePress.Enrollment.dialog.views.length-1&&(CoursePress.Enrollment.dialog.openAt(parseInt(b.last_step)+1),a(".enrolment-container-div").removeClass("hidden")))}),CoursePress.Post.on("coursepress:enrollment:"+d+"_error",function(a){if(void 0!==a.callback&&(c=CoursePress.Enrollment.dialog[a.callback],"function"==typeof c))return void c(a)})}}CoursePress.utility.checkPasswordStrength=function(a,b,c,d,e){var f=a.val(),g=b.val();d&&d.attr("disabled","disabled"),c.removeClass("short bad good strong"),e=e.concat(wp.passwordStrength.userInputBlacklist());var h=wp.passwordStrength.meter(f,e,g);switch(h){case 2:c.addClass("bad").html(pwsL10n.bad);break;case 3:c.addClass("good").html(pwsL10n.good);break;case 4:c.addClass("strong").html(pwsL10n.strong);break;case 5:c.addClass("short").html(pwsL10n.mismatch);break;default:c.addClass("short").html(pwsL10n.short)}return d&&2<h&&5!==h&&""!==g.trim()&&d.removeAttr("disabled"),h},CoursePress.Models.CourseFront=Backbone.Model.extend({url:_coursepress._ajax_url+"?action=course_front",parse:function(a){!0===a.success?(this.set("response_data",a.data),this.trigger("coursepress:"+a.data.action+"_success",a.data)):(this.set("response_data",{}),a.data&&this.trigger("coursepress:"+a.data.action+"_error",a.data))},defaults:{}}),CoursePress.Models.Post=CoursePress.Models.Post||Backbone.Model.extend({url:_coursepress._ajax_url+"?action=",parse:function(a){var b=this.get("context");if(!0===a.success){void 0===a.data&&(a.data={}),this.set("response_data",a.data);var c="coursepress:"+b+a.data.action+"_success";this.trigger(c,a.data)}else 0!==a&&(this.set("response_data",{}),this.trigger("coursepress:"+b+a.data.action+"_error",a.data));CoursePress.Post.set("action","")},prepare:function(a,b){this.url=this.get("base_url")+a,void 0!==b&&this.set("context",b)},defaults:{base_url:_coursepress._ajax_url+"?action=",context:"response:"}}),CoursePress.Post=new CoursePress.Models.Post,CoursePress.Dialogs={beforeSubmit:function(){var c=this.currentIndex;return b(c),c===CoursePress.Enrollment.dialog.views.length-1&&a(".enrolment-container-div").addClass("hidden"),!1},openAtAction:function(b){var c=a('[data-type="modal-step"]');a.each(c,function(c,d){var e=a(d).attr("data-modal-action");void 0!==e&&b===e&&CoursePress.Enrollment.dialog.openAt(c)})},handle_signup_return:function(b){var c=b.signup_errors,d=a('[data-type="modal-step"]');if(0===c.length&&b.user_data.logged_in===!0)_coursepress.invitation_data?CoursePress.Enrollment.dialog.add_instructor(b):a.each(d,function(c,d){var e=a(d).attr("data-modal-action");"yes"===_coursepress.current_course_is_paid&&"paid_enrollment"===e?CoursePress.Enrollment.dialog.openAt(c):"enrolled"===e&&(b.already_enrolled?location.href=_coursepress.course_url:CoursePress.Enrollment.dialog.attempt_enroll(b))});else if(c.length>0){a(".bbm-wrapper #error-messages").html("");var e="<ul>";c.forEach(function(a){e+="<li>"+a+"</li>"}),e+="</ul>",a(".bbm-wrapper #error-messages").html(e),a("input[name=password]").val(""),a("input[name=password_confirmation]").val("")}else a.each(d,function(a,b){var c=b.attr("data-modal-action");"login"===c&&CoursePress.Enrollment.dialog.openAt(a)})},handle_login_return:function(b){var c=b.signup_errors,d=a('[data-type="modal-step"]');if(0===c.length&&b.logged_in===!0)_coursepress.invitation_data?CoursePress.Enrollment.dialog.add_instructor(b):a.each(d,function(c,d){var e=a(d).attr("data-modal-action");"yes"===_coursepress.current_course_is_paid&&"paid_enrollment"===e?CoursePress.Enrollment.dialog.openAt(c):"enrolled"===e&&(b.already_enrolled?location.href=_coursepress.course_url:CoursePress.Enrollment.dialog.attempt_enroll(b))});else if(c.length>0){a(".bbm-wrapper #error-messages").html("");var e="<ul>";c.forEach(function(a){e+="<li>"+a+"</li>"}),e+="</ul>",a(".bbm-wrapper #error-messages").html(e),a("input[name=password]").val("")}},handle_enroll_student_return:function(b){var c=a('[data-type="modal-step"]');!0===b.success&&a.each(c,function(b,c){var d=a(c).attr("data-modal-action");"yes"===_coursepress.current_course_is_paid&&"paid_enrollment"===d?CoursePress.Enrollment.dialog.openAt(b):"enrolled"===d&&CoursePress.Enrollment.dialog.openAt(b)}),a(".enrolment-container-div").removeClass("hidden")},signup_validation:function(){var b=!0;a(".bbm-wrapper #error-messages").html("");var c=[];""!==a("input[name=first_name]").val().trim()&&""!==a("input[name=last_name]").val().trim()&&""!==a("input[name=username]").val().trim()&&""!==a("input[name=email]").val().trim()&&""!==a("input[name=password]").val().trim()&&""!==a("input[name=password_confirmation]").val().trim()||(b=!1,c.push(_coursepress.signup_errors.all_fields));var d=CoursePress.utility.checkPasswordStrength(a("input[name=password]"),a("input[name=password_confirmation]"),a("#password-strength"),!1,[]);if(d<=2&&(b=!1,c.push(_coursepress.signup_errors.weak_password)),5===d&&(b=!1,c.push(_coursepress.signup_errors.mismatch_password)),c.length>0){var e="<ul>";c.forEach(function(a){e+="<li>"+a+"</li>"}),e+="</ul>",a(".bbm-wrapper #error-messages").first().html(e)}return b},login_validation:function(){var b=!0,c=a(".bbm-wrapper #error-messages"),d=a('input[name="log"]'),e=a('input[name="pwd"]');return c.html(""),d.removeClass("has-error"),e.removeClass("has-error"),""===d.val().trim()&&(b=!1,d.addClass("has-error")),""===e.val().trim()&&(b=!1,e.addClass("has-error")),b},signup_data:function(b){return b.first_name=a("input[name=first_name]").val(),b.last_name=a("input[name=last_name]").val(),b.username=a("input[name=username]").val(),b.email=a("input[name=email]").val(),b.password=a("input[name=password]").val(),b.nonce=a(".bbm-modal-nonce.signup").attr("data-nonce"),b},login_data:function(b){var c=a(".enrollment-modal-container.bbm-modal__views").attr("data-course");return b.username=a("input[name=log]").val(),b.password=a("input[name=pwd]").val(),b.course_id=c,b.nonce=a(".bbm-modal-nonce.login").attr("data-nonce"),b},attempt_enroll:function(b){var c=a(".enrollment-modal-container.bbm-modal__views").attr("data-nonce"),d=a(".enrollment-modal-container.bbm-modal__views").attr("data-course"),e=a(".cp-mask");if(void 0===c||void 0===d){var f=a(document.createElement("div"));f.html(_.template(a("#modal-template").html())()),f=a(f).find(".enrollment-modal-container")[0],c=a(f).attr("data-nonce"),d=a(f).attr("data-course")}CoursePress.Post.prepare("course_enrollment","enrollment:"),CoursePress.Post.set("action","enroll_student");var g={nonce:c,student_id:b.user_data.ID,course_id:d,step:""};CoursePress.Post.set("data",g),CoursePress.Post.save(),CoursePress.Post.off("coursepress:enrollment:enroll_student_success"),CoursePress.Post.on("coursepress:enrollment:enroll_student_success",function(b){if(e.removeClass("loading"),a(".enrollment-modal-container.bbm-modal__views").attr("data-nonce",b.nonce),void 0!==b.callback){var c=CoursePress.Enrollment.dialog[b.callback];if("function"==typeof c)return void c(b)}})},new_nonce:function(a,b){CoursePress.Post.prepare("course_enrollment","enrollment:"),CoursePress.Post.set("action","get_nonce");var c={action:"get_nonce",nonce:a,step:""};CoursePress.Post.set("data",c),CoursePress.Post.save(),CoursePress.Post.off("coursepress:enrollment:get_nonce_success"),CoursePress.Post.on("coursepress:enrollment:get_nonce_success",b)},add_instructor:function(a){CoursePress.Enrollment.dialog.new_nonce("coursepress_add_instructor",function(b){var c=_coursepress.invitation_data.course_id;CoursePress.Post.prepare("course_enrollment","enrollment:"),CoursePress.Post.set("action","add_instructor");var d={action:"add_instructor",nonce:b.nonce,course_id:c,invite_code:_coursepress.invitation_data.code,instructor_id:a.user_data.ID,step:""};CoursePress.Post.set("data",d),CoursePress.Post.save(),CoursePress.Post.off("coursepress:enrollment:add_instructor_success"),CoursePress.Post.on("coursepress:enrollment:add_instructor_success",function(){CoursePress.Enrollment.dialog.openAtAction("instructor-verified")}),CoursePress.Post.off("coursepress:enrollment:add_instructor_error"),CoursePress.Post.on("coursepress:enrollment:add_instructor_error",function(){CoursePress.Enrollment.dialog.openAtAction("verification-failed")})})},init:function(){CoursePress.Enrollment.dialog||(CoursePress.Enrollment.dialog=new CoursePress.Modal,_.extend(CoursePress.Enrollment.dialog,CoursePress.Dialogs))}},CoursePress.Enrollment=CoursePress.Enrollment||{},CoursePress.CustomLoginHook=function(){a(this).attr("href","javascript:;");var b=a('<div class="cp-mask enrolment-container-div">');return b.appendTo("body"),CoursePress.Dialogs.init(),b.html(CoursePress.Enrollment.dialog.render().el),CoursePress.Enrollment.dialog.openAtAction("login"),!1},CoursePress.EnrollStudent=function(){var b=a('<div class="cp-mask enrolment-container-div">');if(b.appendTo("body"),CoursePress.Dialogs.init(),"yes"===_coursepress.current_course_is_paid)a(b).html(CoursePress.Enrollment.dialog.render().el),CoursePress.Enrollment.dialog.openAtAction("paid_enrollment");else{a(b).addClass("loading");var c={user_data:{ID:parseInt(_coursepress.current_student)}};CoursePress.Enrollment.dialog.attempt_enroll(c),a(b).html(CoursePress.Enrollment.dialog.render().el)}return!1},CoursePress.validateEnrollment=function(){a(this);return!1},a(document).on("click",".cp-custom-login",CoursePress.CustomLoginHook).on("click",".apply-button.enroll",CoursePress.EnrollStudent).on("submit",".apply-box .enrollment-process",CoursePress.validateEnrollment)}(jQuery);